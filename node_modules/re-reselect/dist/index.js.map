{"version":3,"file":"index.js","sources":["../src/cache/FlatCacheObject.js","../src/cache/FifoCacheObject.js","../src/cache/LruCacheObject.js","../src/index.js"],"sourcesContent":["export default class FlatCacheObject {\n  constructor() {\n    this._cache = {};\n  }\n  set(key, selectorFn) {\n    this._cache[key] = selectorFn;\n  }\n  get(key) {\n    return this._cache[key];\n  }\n  remove(key) {\n    delete this._cache[key];\n  }\n  clear() {\n    this._cache = {};\n  }\n}\n","export default class FifoCacheObject {\n  constructor({cacheSize} = {}) {\n    if (cacheSize === undefined) {\n      throw new Error('Missing the required property `cacheSize`.');\n    }\n    if (!Number.isInteger(cacheSize) || cacheSize <= 0) {\n      throw new Error(\n        'The `cacheSize` property must be a positive integer value.'\n      );\n    }\n    this._cache = {};\n    this._cacheOrdering = [];\n    this._cacheSize = cacheSize;\n  }\n  set(key, selectorFn) {\n    this._cache[key] = selectorFn;\n    this._cacheOrdering.push(key);\n\n    if (this._cacheOrdering.length > this._cacheSize) {\n      const earliest = this._cacheOrdering[0];\n      this.remove(earliest);\n    }\n  }\n  get(key) {\n    return this._cache[key];\n  }\n  remove(key) {\n    const index = this._cacheOrdering.indexOf(key);\n\n    if (index > -1) {\n      this._cacheOrdering.splice(index, 1);\n    }\n    delete this._cache[key];\n  }\n  clear() {\n    this._cache = {};\n    this._cacheOrdering = [];\n  }\n}\n","export default class LruCacheObject {\n  constructor({cacheSize} = {}) {\n    if (cacheSize === undefined) {\n      throw new Error('Missing the required property `cacheSize`.');\n    }\n    if (!Number.isInteger(cacheSize) || cacheSize <= 0) {\n      throw new Error(\n        'The `cacheSize` property must be a positive integer value.'\n      );\n    }\n    this._cache = {};\n    this._cacheOrdering = [];\n    this._cacheSize = cacheSize;\n  }\n  set(key, selectorFn) {\n    this._cache[key] = selectorFn;\n    this._registerCacheHit(key);\n\n    if (this._cacheOrdering.length > this._cacheSize) {\n      const earliest = this._cacheOrdering[0];\n      this.remove(earliest);\n    }\n  }\n  get(key) {\n    this._registerCacheHit(key);\n    return this._cache[key];\n  }\n  remove(key) {\n    this._deleteCacheHit(key);\n    delete this._cache[key];\n  }\n  clear() {\n    this._cache = {};\n    this._cacheOrdering = [];\n  }\n  _registerCacheHit(key) {\n    this._deleteCacheHit(key);\n    this._cacheOrdering.push(key);\n  }\n  _deleteCacheHit(key) {\n    const index = this._cacheOrdering.indexOf(key);\n    if (index > -1) {\n      this._cacheOrdering.splice(index, 1);\n    }\n  }\n}\n","import {createSelector} from 'reselect';\nimport FlatCacheObject from './cache/FlatCacheObject';\n\nexport default function createCachedSelector(...funcs) {\n  const defaultCacheCreator = FlatCacheObject;\n\n  return (resolver, options = {}) => {\n    let cache;\n    let selectorCreator;\n\n    // Allow \"options\" to be provided as a \"selectorCreator\" for backward compatibility\n    // @TODO Remove \"options\" as a function in next breaking release\n    if (typeof options === 'function') {\n      console.warn(\n        '[re-reselect] Deprecation warning: \"selectorCreator\" argument is discouraged and will be removed in the upcoming major release. Please use \"options.selectorCreator\" instead.'\n      );\n      cache = new defaultCacheCreator();\n      selectorCreator = options;\n    } else {\n      cache = options.cacheObject || new defaultCacheCreator();\n      selectorCreator = options.selectorCreator || createSelector;\n    }\n\n    const selector = function(...args) {\n      // Application receives this function\n      const cacheKey = resolver(...args);\n\n      if (typeof cacheKey === 'string' || typeof cacheKey === 'number') {\n        let cacheResponse = cache.get(cacheKey);\n\n        if (cacheResponse === undefined) {\n          cacheResponse = selectorCreator(...funcs);\n          cache.set(cacheKey, cacheResponse);\n        }\n\n        return cacheResponse(...args);\n      }\n      return undefined;\n    };\n\n    // Further selector methods\n    selector.getMatchingSelector = (...args) => {\n      const cacheKey = resolver(...args);\n      // @NOTE It might update cache hit count in LRU-like caches\n      return cache.get(cacheKey);\n    };\n\n    selector.removeMatchingSelector = (...args) => {\n      const cacheKey = resolver(...args);\n      cache.remove(cacheKey);\n    };\n\n    selector.clearCache = () => {\n      cache.clear();\n    };\n\n    selector.resultFunc = funcs[funcs.length - 1];\n\n    return selector;\n  };\n}\n\nexport {FlatCacheObject};\nexport {default as FifoCacheObject} from './cache/FifoCacheObject';\nexport {default as LruCacheObject} from './cache/LruCacheObject';\n"],"names":["FlatCacheObject","_cache","set","key","selectorFn","get","remove","clear","FifoCacheObject","cacheSize","undefined","Error","Number","isInteger","_cacheOrdering","_cacheSize","push","length","earliest","index","indexOf","splice","LruCacheObject","_registerCacheHit","_deleteCacheHit","createCachedSelector","funcs","defaultCacheCreator","resolver","options","cache","selectorCreator","warn","cacheObject","createSelector","selector","cacheKey","cacheResponse","getMatchingSelector","removeMatchingSelector","clearCache","resultFunc"],"mappings":"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"}